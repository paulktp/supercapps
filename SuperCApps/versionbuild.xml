<?xml version="1.0" encoding="UTF-8"?>
<project name="RCA" default="minor">

<property file="build_info.properties"/>
<property name="build.number" value="${build.major.number}.${build.revision.number}.${build.minor.number}"/>

<target name="current-number">
 <echo>Current build number:${build.number}</echo>
</target>

<target name="compile">
   <antcall target="revision"></antcall>
</target>

<target name="dist">
  <antcall target="minor"></antcall>
</target>

<target name="revision">
    <propertyfile  file="build_info.properties">
            <entry key="build.revision.number" type="int" operation="+" value="1" pattern="0"/>
            <entry key="build.minor.number" type="int" value="0" pattern="00"/>
    </propertyfile>
    <replaceregexp file="assets\www\config.xml" match='version="[0-9].[0-9].[0-9][0-9]*"' replace='version="${build.major.number}.${build.revision.number}.${build.minor.number}"' />
</target>

<target name="minor">
    <propertyfile  file="build_info.properties">
            <entry key="build.minor.number" type="int" operation="+" value="1" pattern="00"/>
    </propertyfile>
     <replaceregexp file="assets\www\config.xml" match='version="[0-9].[0-9].[0-9][0-9]*"' replace='version="${build.major.number}.${build.revision.number}.${build.minor.number}"' />
</target> 

<target name="major">
    <propertyfile  file="build_info.properties">
            <entry key="build.major.number" type="int" operation="+" value="1" pattern="0"/>
            <entry key="build.minor.number" type="int" value="0" pattern="00"/>
            <entry key="build.revision.number" type="int" value="0" pattern="0"/>
    </propertyfile>
    <replaceregexp file="assets\www\config.xml" match='version="[0-9].[0-9].[0-9][0-9]*"' replace='version="${build.major.number}.${build.revision.number}.${build.minor.number}"' />
	<echo>Current build number:${build.major.number}.${build.revision.number}.${build.minor.number}</echo>
</target>

<target name="all">
    <propertyfile  file="build_info.properties">
            <entry key="build.major.number" type="int" operation="+" value="1" pattern="0"/>
            <entry key="build.minor.number" type="int" operation="+" value="1" pattern="00"/>
            <entry key="build.revision.number" type="int" operation="+" value="1" pattern="0"/>
    </propertyfile>
   <replaceregexp file="assets\www\config.xml" match='version="[0-9].[0-9].[0-9][0-9]*"' replace='version="${build.major.number}.${build.revision.number}.${build.minor.number}"' />
</target>


</project>

<!-- <project default="svn-revision">
    <target name="svn-revision">
        <exec executable="sh" outputproperty="revision">
            <arg value="-c" />
            <arg value="svnversion | sed -e 's/^[^:]*://;s/[A-Za-z]//'" />
        </exec>
        <echo>Revision (app): ${revision}</echo>
        <replaceregexp file="AndroidManifest.xml" match='android:versionCode="([^".]+)(\.[^"]*)?"' replace='android:versionCode="${revision}"' />
    </target>
</project>
-->
<!--
 <project name="RCA" default="default"> 
	<target name="default">
		<buildnumber file="file.with.buildnumber.properies"/>
		 <replaceregexp file="assets\www\config.xml" match='version="([^".]+)(\.[^"]*)?"' replace='version="1.1.1"' />
	</target>
</project>
 -->